import os
import logging
from telegram import Update
from telegram.ext import ApplicationBuilder, CommandHandler, MessageHandler, ContextTypes, filters
from keep_alive import keep_alive

# âœ… Ø¥Ø¹Ø¯Ø§Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
logging.basicConfig(level=logging.INFO)

# âœ… Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ØªÙˆÙƒÙ† Ø§Ù„Ø¨ÙˆØª Ù…Ù† Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø©
BOT_TOKEN = os.environ.get("BOT_TOKEN")

# âœ… Ø£Ù…Ø± /start
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text("Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ! Ø£Ù†Ø§ Ø§Ù„Ø¨ÙˆØª Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ âœ¨")

# âœ… Ø£Ù…Ø± Ø§Ø®ØªØ¨Ø§Ø±
async def ping(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text("ğŸ“ Pong!")

# âœ… Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø£ÙŠ Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ©
async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text(f"Ø£Ù†Øª Ù‚Ù„Øª: {update.message.text}")

# âœ… Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
def main():
    keep_alive()  # Ø¥Ø¨Ù‚Ø§Ø¡ Ø§Ù„Ø³ÙŠØ±ÙØ± Ø´ØºØ§Ù„ Ø¹Ù„Ù‰ Render

    if not BOT_TOKEN:
        raise ValueError("âŒ ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ùƒ Ø£Ø¶ÙØª BOT_TOKEN ÙÙŠ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø©")

    app = ApplicationBuilder().token(BOT_TOKEN).build()

    app.add_handler(CommandHandler("start", start))
    app.add_handler(CommandHandler("ping", ping))
    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_message))

    app.run_polling()

# âœ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬
if __name__ == "__main__":
    main()
